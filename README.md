# GBERT
Программа для классификации англоязычных статей по кодами ГРНТИ.

## Установка:

1. Установите зависимости из файла `requirements.txt` командой
 ```bash
pip install -r requirements.txt
 ```
2. Скачайте 3 модели BERT по ссылке [здесь](https://huggingface.co/Wilstonio/GBERT_1/tree/main) и поместите их в директорию `/models`.

## Примерная команда для запуска:

```bash
python GBERT.py -i input_sample.txt -o output_sample.txt -t 0.1 -id RGNTI3 -n not
```

| Аргумент                            | Ключ | Описание                                               | Обязательный |
|-------------------------------------|------|--------------------------------------------------------|--------------|
| Входной файл                       | -i   | Путь к существующему файлу с текстами                 | Да           |
| Выходной файл                      | -o   | Путь к файлу для записи результатов                   | Да           |
| Идентификатор рубрикатора          | -id  | RGNTI3 – все уровни ГРНТИ;                            | Нет, по умолчанию – ‘RGNTI3’ |
|                                     |      | RGNTI2 – первые два уровня ГРНТИ;                     |              |
|                                     |      | RGNTI1 – первый уровень ГРНТИ.                        |              |
| Минимальная вероятность рубрики    | -t   | Порог уверенности модели в предсказании.              | Да           |
| Нормализация                       | -n   | При all – все результаты;                             | Нет, по умолчанию – not |
|                                     |      | При some – результаты, где сумма вероятностей > 1.;   |              |
|                                     |      | При not – не нормализовывать.                         |              |

## Формат данных:

**Пример входного файла:** `input_sample`

**Пример файла с результатами:** `output_sample`

Входной файл состоит из следующих полей:

- `id`: идентификатор
- `title`: название статьи
- `text`: текст статьи
- `keywords`: ключевые слова
- `correct`: знак валидности (всегда содержит '###')

Файл с результатами состоит из следующих полей:

- `id`: идентификатор
- `result`: результат классификации в формате "рубрика1-вероятность1/рубрика2-
вероятность2...", где вероятность – это уверенность классификатора в 
принадлежности текста к определенной рубрике
- `rubricator`: уровень классификации
- `language`: язык классификации (всегда содержит 'en')
- `threshold`:  заданная при классификации минимальная вероятность рубрик
- `version`:  версия приложения
- `normalize`:  заданная при классификации нормализация ('all'/'some'/'not')
- `correct`: знак валидности (всегда содержит '###')

## Структура проекта:

`GBERT.py` — основной файл для запуска.
- `/dictionaries`: Директория, содержит англоязычные словари для первого и второго уровней ГРНТИ. Ключом является категория, а значением — название категории
- `/models`: Директория, должна содержать три модели ГРНТИ, которые можно скачать [здесь](https://huggingface.co/Wilstonio/GBERT_1/tree/main)
- `/models/mapping`: Директория с маппингом моделей
- `/core`: Директория с файлами для работы основной функции `GBERT.py`
    - `cli.py`: Содержит параметры для командной утилиты
    - `config.py`: Содержит конфиг с путями и константами
    - `utils.py`: Содержит класс для работы с моделями, набором данных и функциями форматирования результатов
 
 ## Алгоритм классификации:

 

    
